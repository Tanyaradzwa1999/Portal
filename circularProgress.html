<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Circular Progress Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f5f5f5;
      }
      #progress-chart-container {
        width: 300px;
        height: 300px;
        background-color: #ffffff;
        padding: 20px;
        border-radius: 50%;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
      }
      canvas {
        width: 100%;
        height: 100%;
      }
      .chart-title {
        position: absolute;
        top: 10px;
        width: 100%;
        text-align: center;
        font-size: 18px;
        font-weight: bold;
      }
      .chart-percentage {
        position: absolute;
        bottom: 10px;
        width: 100%;
        text-align: center;
        font-size: 16px;
      }
      .control-panel {
        text-align: center;
        margin-top: 20px;
      }
      .control-panel input {
        padding: 5px;
        font-size: 16px;
        width: 60px;
        text-align: center;
      }
      .control-panel button {
        padding: 5px 10px;
        font-size: 16px;
        margin-left: 10px;
      }
    </style>
  </head>
  <body>
    <div id="progress-chart-container">
      <div class="chart-title">Student Attendance</div>
      <canvas id="progressChart"></canvas>
      <div class="chart-percentage" id="percentage-display">0%</div>
    </div>

    <div class="control-panel">
      <label for="percentage-input">Set Percentage:</label>
      <input type="number" id="percentage-input" min="0" max="100" value="75" />
      <div class="update"></div>
    </div>

    <script>
      let progressChart;
      let fillColor;
      const update = document.querySelector(".update");
      update.addEventListener("click", updatePercentage);
      function createCircularProgressChart(percentage) {
        const ctx = document.getElementById("progressChart").getContext("2d");

        // Determine fill color based on percentage
        if (percentage >= 0 && percentage <= 30) {
          fillColor = "#FF4433"; // Red for <30%, Green otherwise
        }
        if (percentage > 30 && percentage <= 50) {
          fillColor = "#FFBF00"; // Red for <30%, Green otherwise
        }

        if (percentage > 50 && percentage <= 70) {
          fillColor = "#FFBF00"; // Red for <30%, Green otherwise
        }

        if (percentage > 70 && percentage <= 80) {
          fillColor = "#90EE90"; // Red for <30%, Green otherwise
        }

        if (percentage > 80 && percentage <= 100) {
          fillColor = "#228B22"; // Red for <30%, Green otherwise
        }

        const data = {
          datasets: [
            {
              data: [percentage, 100 - percentage],
              backgroundColor: [fillColor, "#e0e0e0"],
              borderWidth: 0,
            },
          ],
        };
        const options = {
          responsive: true,
          maintainAspectRatio: false,
          cutout: "80%",
          rotation: -0.5 * Math.PI,
          plugins: {
            tooltip: { enabled: false },
          },
        };

        // Destroy existing chart instance if any
        if (progressChart) {
          progressChart.destroy();
        }

        progressChart = new Chart(ctx, {
          type: "doughnut",
          data: data,
          options: options,
        });

        document.getElementById("percentage-display").textContent =
          percentage + "%";
      }

      // Initial chart creation with a default percentage
      createCircularProgressChart(75); // Example: 75% attendance

      // Function to update the chart percentage from the input field
      function updatePercentage() {
        const percentage = parseInt(
          document.getElementById("percentage-input").value,
          10
        );
        if (percentage >= 0 && percentage <= 100) {
          createCircularProgressChart(percentage);
        } else {
          alert("Please enter a percentage between 0 and 100.");
        }
      }
    </script>
  </body>
</html>
